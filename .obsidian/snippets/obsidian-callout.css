/* ================================================================= */
/*  VS Code Math Layout - Clean Textbook Style (Final Optimized)     */
/*  1. 全局: 强制白纸黑字, 字体跟随编辑器设置                             */
/*  2. Type A (Thm/Def): 仿 LaTeX 教科书风格 (圆角, 阴影)                */
/*  3. Type B (Proof): 保持透明背景 + 细线                               */
/*  4. Type C (Note/Remark): 侧边栏风格 (无标题栏, 斜体, 紧凑布局)         */
/* ================================================================= */

/* --- 强制覆盖 VS Code 的默认背景 --- */
body, .vscode-body, .vscode-light, .vscode-dark {
  background-color: #ffffff !important;
  color: #222222 !important;
  line-height: 1.2; 
}


body {
  color-scheme: light;

  /* --- 基础颜色定义 (RGB) --- */
  /* Type A: 核心数学环境 */
  --color-theorem-rgb: 85, 70, 180;     /* Deep Violet */
  --color-lemma-rgb: 120, 50, 150;      /* Deep Purple */
  --color-definition-rgb: 0, 90, 160;   /* Deep Blue */
  --color-proposition-rgb: 180, 60, 60; /* Deep Red-Brown */
  --color-corollary-rgb: 210, 100, 0;   /* Deep Orange */
  --color-example-rgb: 180, 140, 40;    /* Deep Gold */
  --color-exercise-rgb: 44, 62, 80;     /* Midnight Blue */

  /* Type B: 证明 */
  --color-gray-rgb: 100, 100, 100;

   /* Solution 专用颜色 (森林绿) */
  --color-solution-rgb: 34, 139, 34;   /* ForestGreen */

  /* Type C: 辅助/笔记 */
  --color-remark-rgb: 0, 128, 128;       /* Teal */
  --color-proofsketch-rgb: 41, 128, 185; /* Strong Blue */
  --color-note-rgb: 200, 50, 50;         /* Strong Red */

  /* --- 尺寸与字体 --- */
  --line-height-tight: 1.2; 
  --font-weight-bold: 700;     

  /* --- Callout 变量映射 --- */
  --callout-default: var(--color-definition-rgb);
  --callout-theorem: var(--color-theorem-rgb);
  --callout-lemma: var(--color-lemma-rgb);
  --callout-definition: var(--color-definition-rgb);
  --callout-proposition: var(--color-proposition-rgb);
  --callout-corollary: var(--color-corollary-rgb);
  --callout-example: var(--color-example-rgb);
  --callout-exercise: var(--color-exercise-rgb);
  --callout-problem: var(--color-exercise-rgb); 
  --callout-solution: var(--color-solution-rgb);
  --callout-proof: var(--color-gray-rgb);

  --callout-remark: var(--color-remark-rgb);
  --callout-proofsketch: var(--color-proofsketch-rgb);
  --callout-note: var(--color-note-rgb); 
}

/* ================================================================= */
/*  1. 通用基础设置 (Type A Default - Textbook Style)                */
/* ================================================================= */

.callout {
  --callout-color: var(--callout-default);
  padding: 0; 
  overflow: hidden;
  margin: 1.5em 0; 
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); 
  border-radius: 6px; 
  background-color: #fff; 
  border: 1px solid rgb(var(--callout-color)); 
}

.callout-icon { display: none !important; }

/* 标题栏 (Type A) */
.callout-title {
  background-color: rgb(var(--callout-color)); 
  color: #ffffff !important; 
  padding: 6px 15px; 
  min-height: 0 !important;
  line-height: var(--line-height-tight);
  font-weight: var(--font-weight-bold);
  font-size: 1em; 
  display: flex;
  align-items: center;
}

/* 内容区 (Type A) */
.callout-content {
  background-color: rgba(var(--callout-color), 0.04); 
  color: #222222 !important; 
  padding: 6px 15px 12px 15px; 
  overflow-x: auto;
  font-size: 1em;
}

/* ================================================================= */
/*  2. 环境颜色绑定                                                  */
/* ================================================================= */

.callout[data-callout="theorem"] { --callout-color: var(--callout-theorem); }
.callout[data-callout="lemma"] { --callout-color: var(--callout-lemma); }
.callout[data-callout="definition"] { --callout-color: var(--callout-definition); }
.callout[data-callout="proposition"] { --callout-color: var(--callout-proposition); }
.callout[data-callout="corollary"] { --callout-color: var(--callout-corollary); }
.callout[data-callout="example"] { --callout-color: var(--callout-example); }
.callout[data-callout="exercise"] { --callout-color: var(--callout-exercise); }
.callout[data-callout="problem"] { --callout-color: var(--callout-problem); }
.callout[data-callout="solution"] { --callout-color: var(--callout-solution); }

/* Type C 类 */
.callout[data-callout="remark"] { --callout-color: var(--callout-remark); }
.callout[data-callout="proofsketch"] { --callout-color: var(--callout-proofsketch); }
.callout[data-callout="note"] { --callout-color: var(--callout-note); }

/* ================================================================= */
/*  3. Type B: 证明与解答风格 (Proof & Solution)                     */
/* ================================================================= */

.callout[data-callout="proof"],
.callout[data-callout="solution"] {
  background-color: transparent;
  border: none;
  border-left: 3px solid rgba(var(--callout-color), 0.4);
  box-shadow: none; 
  border-radius: 0;
  margin: 1em 0;
}

.callout[data-callout="proof"] .callout-title,
.callout[data-callout="solution"] .callout-title {
  background-color: transparent; 
  color: #555555 !important; 
  padding: 2px 15px;
  font-style: italic;
}

.callout[data-callout="proof"] .callout-content,
.callout[data-callout="solution"] .callout-content {
  background-color: transparent; 
  padding: 5px 15px;
}

.callout[data-callout="proof"] .callout-content::after,
.callout[data-callout="solution"] .callout-content::after {
  content: "∎";
  display: block;
  text-align: right;
  margin-top: 5px;
  color: #666;
  font-style: normal;
}

/* ================================================================= */
/*  4. Type C: 侧边栏风格 (Remark, Note, Proofsketch)                */
/*  [关键修改] 移除了标题底部的 padding，消除与列表的空隙                  */
/* ================================================================= */

.callout[data-callout="remark"],
.callout[data-callout="proofsketch"],
.callout[data-callout="note"] {
  border: none !important;
  border-left: 5px solid rgb(var(--callout-color)) !important;
  background-color: rgba(var(--callout-color), 0.08) !important; 
  border-radius: 0 !important; 
  box-shadow: none !important; 
}

.callout[data-callout="remark"] .callout-title,
.callout[data-callout="proofsketch"] .callout-title,
.callout[data-callout="note"] .callout-title {
  background-color: transparent !important;
  color: #000000 !important;
  font-style: italic;
  font-weight: normal; 
  /* 底部 padding 设为 0，让内容紧贴标题 */
  padding: 10px 15px 0px 15px;
}

.callout[data-callout="remark"] .callout-content,
.callout[data-callout="proofsketch"] .callout-content,
.callout[data-callout="note"] .callout-content {
  background-color: transparent !important;
  padding: 0px 15px 10px 15px;
}

/* ================================================================= */
/*  5. 兼容性补丁: 强制覆盖 VS Code 原生 Note 样式                     */
/* ================================================================= */

.markdown-alert .codicon,
.markdown-alert-title > svg, 
.markdown-alert-title .markdown-alert-icon { display: none !important; }

.markdown-alert.markdown-alert-note {
  --callout-color: var(--color-note-rgb);
  border: none !important;
  border-left: 5px solid rgb(var(--callout-color)) !important;
  background-color: rgba(var(--callout-color), 0.08) !important;
  border-radius: 0 !important;
  padding: 0 !important;
  margin: 1.5em 0;
  box-shadow: none !important;
}

.markdown-alert.markdown-alert-note .markdown-alert-title {
  background-color: transparent !important;
  color: #000000 !important;
  font-style: italic;
  font-weight: normal;
  padding: 10px 15px 0px 15px; /* 同样移除底部 padding */
  margin: 0 !important;
  display: block;
}

.markdown-alert.markdown-alert-note > *:not(.markdown-alert-title) {
  padding: 0px 15px 10px 15px;
  margin-bottom: 0;
}

/* ================================================================= */
/*  6. 列表排版优化 (List Layout Optimization) [增强版]               */
/*  彻底解决列表顶部的空隙问题                                           */
/* ================================================================= */

/* 1. 统一列表基础缩进和间距 */
.callout-content ul,
.callout-content ol {
  padding-left: 0.0em !important;
  margin-bottom: -0.8em;
  margin-top: -0.8em;
}

/* 2. [核心] 强制消除作为第一个元素的列表顶部间距 */
/* 只要列表是内容区的第一个元素，就强制 margin-top 为 0 */
.callout-content > ul:first-child,
.callout-content > ol:first-child {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

/* 3. 列表项之间的呼吸感 */
.callout-content li {
  margin-bottom: 0.2em;
  line-height: var(--line-height-tight);
}

/* 4. 隐藏可能存在的空段落 (防止 Markdown 解析出空行占位) */
.callout-content > p:empty {
  display: none;
  margin: 0;
}

/* ================================================================= */
/*  7. 杂项修正                                                      */
/* ================================================================= */

p {
  margin-block-start: 0.8em;
  margin-block-end: 0.8em;
}

/* 确保内容区第一个元素（无论是P还是List）都没有上边距 */
.callout-content > :first-child { 
  margin-top: 0 !important; 
}

.callout-content > :last-child { 
  margin-bottom: 0 !important; 
}

::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-thumb { background: #ccc; border-radius: 5px; }
::-webkit-scrollbar-track { background: transparent; }

/* ================================================================= */
/*  8. 公式显示优化 (Math Formula Enhancement)                       */
/* ================================================================= */

/* 统一放大公式至 115% (覆盖 KaTeX 和 MathJax) */
.katex, .mjx-container, .MathJax {
  font-size: 1.15em !important;
}


/* 强制所有段落和列表使用新的行高 */
p, li, .callout-content {
  line-height: 1.2 !important; 
}
